<Window x:Class="BarcodePrinterApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:BarcodePrinterApp"
        Title="Печать штрих-кодов" Height="600" Width="1022">
    <Grid>
        <Grid.RowDefinitions>
            <!-- Автоматическая высота для кнопок -->
            <RowDefinition Height="Auto" MinHeight="38.63"/>
            <!-- Фиксированная высота для DataGrid -->
            <RowDefinition Height="300"/>
            <!-- Оставшееся пространство для области предпросмотра -->
            <RowDefinition/>
        </Grid.RowDefinitions>

        <!-- Кнопки управления с иконками -->
        <Grid Grid.Row="0" Margin="10,10,10,10">
            <Grid.ColumnDefinitions>
                <!-- Кнопки -->
                <ColumnDefinition Width="Auto"/>
                <!-- Пустое пространство между кнопками и RadioButton -->
                <ColumnDefinition Width="*"/>
                <!-- RadioButton -->
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Кнопки -->
            <StackPanel Grid.Column="0" Orientation="Horizontal">
                <Button Content="📂 Выбрать файл" Click="SelectFileButton_Click" Margin="0,0,10,0"/>
                <Button Content="🖨 Печать" Click="PrintButton_Click"/>
            </StackPanel>

            <!-- RadioButton -->
            <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                <RadioButton x:Name="RadioButtonOS" Content="ОС" GroupName="LabelText" Margin="5,0" Checked="RadioButton_Checked" IsChecked="True"/>
                <RadioButton x:Name="RadioButtonTMS" Content="ТМЦ" GroupName="LabelText" Margin="5,0" Checked="RadioButton_Checked"/>
            </StackPanel>
        </Grid>

        <!-- DataGrid с улучшенной производительностью -->
        <DataGrid x:Name="AssetsGrid"
                  Grid.Row="1"
                  VirtualizingPanel.IsVirtualizing="True"
                  VirtualizingPanel.VirtualizationMode="Recycling"
                  EnableRowVirtualization="True"
                  SelectionMode="Extended"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  Margin="10,0,10,10"
                  ItemsSource="{Binding}">
            <DataGrid.Columns>

                <DataGridTemplateColumn Width="30">
                    <DataGridTemplateColumn.Header>
                        <CheckBox IsChecked="{Binding IsAllSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                  Click="HeaderCheckBox_Click" />
                    </DataGridTemplateColumn.Header>
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <CheckBox IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" 
                      VerticalAlignment="Center"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTextColumn Header="№" 
                                  Binding="{Binding Id}"
                                  Width="Auto"
                                  IsReadOnly="True"/>

                <DataGridTextColumn Header="Инвентарный №" 
                                  Binding="{Binding InventoryNumber}"
                                  Width="*"/>

                <DataGridTextColumn Header="Наименование" 
                                  Binding="{Binding Name}"
                                  Width="2*"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Область предпросмотра -->
        <Border Grid.Row="2" BorderBrush="LightGray" BorderThickness="0,1" Margin="10,10,10,10">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <ItemsControl x:Name="PreviewContainer"
                            VirtualizingPanel.IsVirtualizing="True"
                            VirtualizingPanel.VirtualizationMode="Recycling">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Margin="5" 
                                  BorderBrush="LightGray" 
                                  BorderThickness="1">
                                <local:BarcodeLabel 
                                  Width="150" 
                                  Height="100"
                                  DataContext="{Binding}"/>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Border>
    </Grid>
</Window>